<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Databases &mdash; Caleb Sargeant&#39;s Docs 1.0.1 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="General" href="general.html" />
    <link rel="prev" title="Linux" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Caleb Sargeant's Docs
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Networking</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../networking/cisco/index.html">Cisco</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../networking/mikrotik.html">Mikrotik</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../networking/fortigate.html">FortiGate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../networking/hp.html">HP Procurve</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../networking/juniper.html">Juniper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../networking/ubiquiti-unifi.html">Ubiquiti UniFi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../networking/netdevops-toolchest.html">NetDevOps Tool Chest</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Computing</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../ansible/index.html">Ansible</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bamboo.html">Bamboo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cloud/index.html">Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../containerisation/index.html">Containerisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jenkins/index.html">Jenkins</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Linux</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Databases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mysql">MySQL</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#creating-a-user">Creating a User</a></li>
<li class="toctree-l4"><a class="reference internal" href="#deleting-a-user">Deleting a User</a></li>
<li class="toctree-l4"><a class="reference internal" href="#showing-users">Showing Users</a></li>
<li class="toctree-l4"><a class="reference internal" href="#logging-in-remotely">Logging in Remotely</a></li>
<li class="toctree-l4"><a class="reference internal" href="#privileges">Privileges</a></li>
<li class="toctree-l4"><a class="reference internal" href="#granting-privileges">Granting Privileges</a></li>
<li class="toctree-l4"><a class="reference internal" href="#revoking-privileges">Revoking Privileges</a></li>
<li class="toctree-l4"><a class="reference internal" href="#showing-privileges">Showing Privileges</a></li>
<li class="toctree-l4"><a class="reference internal" href="#updating-data">Updating Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#deleting-data">Deleting Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#checking-mysql-status">Checking MySQL Status</a></li>
<li class="toctree-l4"><a class="reference internal" href="#backup">Backup</a></li>
<li class="toctree-l4"><a class="reference internal" href="#restore">Restore</a></li>
<li class="toctree-l4"><a class="reference internal" href="#use">Use</a></li>
<li class="toctree-l4"><a class="reference internal" href="#setting-up-replication">Setting up Replication</a></li>
<li class="toctree-l4"><a class="reference internal" href="#size-of-db">Size of DB</a></li>
<li class="toctree-l4"><a class="reference internal" href="#resetting-root-password">Resetting Root Password</a></li>
<li class="toctree-l4"><a class="reference internal" href="#resetting-user-password">Resetting User Password</a></li>
<li class="toctree-l4"><a class="reference internal" href="#update-encrypted-password">Update Encrypted Password</a></li>
<li class="toctree-l4"><a class="reference internal" href="#allow-root-access-without-password-as-root">Allow Root Access without Password as Root</a></li>
<li class="toctree-l4"><a class="reference internal" href="#checking-the-version">Checking the Version</a></li>
<li class="toctree-l4"><a class="reference internal" href="#checking-database-size">Checking Database Size</a></li>
<li class="toctree-l4"><a class="reference internal" href="#connect-to-database-remotely">Connect to Database Remotely</a></li>
<li class="toctree-l4"><a class="reference internal" href="#import-database-with-progress-bar">Import Database with Progress Bar</a></li>
<li class="toctree-l4"><a class="reference internal" href="#reinstall-mysql-after-deleting-var-lib-mysql">Reinstall Mysql after Deleting /var/lib/mysql</a></li>
<li class="toctree-l4"><a class="reference internal" href="#could-not-open-mysql-plugin-table">Could not open mysql.plugin table</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mysql-refuses-remote-connections">Mysql Refuses Remote Connections</a></li>
<li class="toctree-l4"><a class="reference internal" href="#access-denied-for-user-root-at-localhost">Access Denied for User Root at Localhost</a></li>
<li class="toctree-l4"><a class="reference internal" href="#authentication-plugin-caching-sha2-password-cannot-be-loaded">Authentication Plugin Caching Sha2 Password Cannot be Loaded</a></li>
<li class="toctree-l4"><a class="reference internal" href="#change-mysql-temp-folder">Change MySQL Temp Folder</a></li>
<li class="toctree-l4"><a class="reference internal" href="#installing-mysql">Installing MySQL</a></li>
<li class="toctree-l4"><a class="reference internal" href="#json-like-query">Json Like Query</a></li>
<li class="toctree-l4"><a class="reference internal" href="#converting-epoch-to-human-readable-date">Converting Epoch to Human Readable Date</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#postgresql">PostgreSQL</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#deleting-rows">Deleting Rows</a></li>
<li class="toctree-l4"><a class="reference internal" href="#selecting-rows">Selecting Rows</a></li>
<li class="toctree-l4"><a class="reference internal" href="#updating-data-in-table">Updating Data in Table</a></li>
<li class="toctree-l4"><a class="reference internal" href="#show-tables">Show Tables</a></li>
<li class="toctree-l4"><a class="reference internal" href="#connect-to-database">Connect to Database</a></li>
<li class="toctree-l4"><a class="reference internal" href="#backup-database">Backup Database</a></li>
<li class="toctree-l4"><a class="reference internal" href="#disable-pager">Disable Pager</a></li>
<li class="toctree-l4"><a class="reference internal" href="#extracting-json">Extracting JSON</a></li>
<li class="toctree-l4"><a class="reference internal" href="#reducing-disk-usage">Reducing Disk Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#show-running-queries">Show Running Queries</a></li>
<li class="toctree-l4"><a class="reference internal" href="#connect-to-postgresql-server-fatal-no-pg-hba-conf-entry-for-host">Connect to PostgreSQL server FATAL no pg_hba.conf entry for host</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vacuum">Vacuum</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="general.html">General</a></li>
<li class="toctree-l2"><a class="reference internal" href="iptables.html">IPTables</a></li>
<li class="toctree-l2"><a class="reference internal" href="kvm.html">KVM</a></li>
<li class="toctree-l2"><a class="reference internal" href="monitoring.html">Monitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="nagios.html">Nagios</a></li>
<li class="toctree-l2"><a class="reference internal" href="nagios.html#adding-linux-hosts">Adding Linux Hosts</a></li>
<li class="toctree-l2"><a class="reference internal" href="networking.html">Networking</a></li>
<li class="toctree-l2"><a class="reference internal" href="prometheus.html">Prometheus</a></li>
<li class="toctree-l2"><a class="reference internal" href="raspberry.html">Raspberry Pi</a></li>
<li class="toctree-l2"><a class="reference internal" href="storage.html">Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="training.html">Training</a></li>
<li class="toctree-l2"><a class="reference internal" href="ufw.html">UFW</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../terraform/index.html">Terraform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../microsoft/index.html">Microsoft</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Programming</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../programming/bash.html">Bash</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../programming/python/index.html">Python</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../other/api/index.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../other/general/index.html">General</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../other/iperf.html">iPerf3</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Caleb Sargeant's Docs</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">Linux</a> &raquo;</li>
      <li>Databases</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/computing/linux/databases.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="databases">
<h1>Databases<a class="headerlink" href="#databases" title="Permalink to this headline"></a></h1>
<section id="mysql">
<h2>MySQL<a class="headerlink" href="#mysql" title="Permalink to this headline"></a></h2>
<section id="creating-a-user">
<h3>Creating a User<a class="headerlink" href="#creating-a-user" title="Permalink to this headline"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Note that localhost could be a location somewhere else, like a source IP Address of machine connecting to mysql</span>
create user <span class="s1">&#39;myuser&#39;</span>@<span class="s1">&#39;localhost&#39;</span> identified by <span class="s1">&#39;password&#39;</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="deleting-a-user">
<h3>Deleting a User<a class="headerlink" href="#deleting-a-user" title="Permalink to this headline"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Note that localhost could be a location somewhere else, like a source IP Address of machine connecting to mysql</span>
drop user <span class="s1">&#39;user&#39;</span>@<span class="s1">&#39;localhost&#39;</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="showing-users">
<h3>Showing Users<a class="headerlink" href="#showing-users" title="Permalink to this headline"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="k">select</span> user from mysql.user<span class="p">;</span>
<span class="k">select</span> user,host from mysql.user<span class="p">;</span>
</pre></div>
</div>
</section>
<section id="logging-in-remotely">
<h3>Logging in Remotely<a class="headerlink" href="#logging-in-remotely" title="Permalink to this headline"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># You can -p&#39;mypassword&#39; as well</span>
mysql -u myuser -p -h mydbhostname.com -D mydatabase
</pre></div>
</div>
</section>
<section id="privileges">
<h3>Privileges<a class="headerlink" href="#privileges" title="Permalink to this headline"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ALL PRIVILEGES- as we saw previously, this would allow a MySQL user full access to a designated database <span class="o">(</span>or <span class="k">if</span> no database is selected, global access across the system<span class="o">)</span>
CREATE- allows them to create new tables or databases
DROP- allows them to them to delete tables or databases
DELETE- allows them to delete rows from tables
INSERT- allows them to insert rows into tables
SELECT- allows them to use the SELECT <span class="nb">command</span> to <span class="nb">read</span> through databases
UPDATE- allow them to update table rows
GRANT OPTION- allows them to grant or remove other users’ privileges
</pre></div>
</div>
</section>
<section id="granting-privileges">
<h3>Granting Privileges<a class="headerlink" href="#granting-privileges" title="Permalink to this headline"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Note that localhost could be a location somewhere else, like a source IP Address of machine connecting to mysql</span>
grant all privileges on mydb.* to <span class="s1">&#39;user&#39;</span>@<span class="s1">&#39;localhost&#39;</span><span class="p">;</span>
flush privileges<span class="p">;</span>
</pre></div>
</div>
</section>
<section id="revoking-privileges">
<h3>Revoking Privileges<a class="headerlink" href="#revoking-privileges" title="Permalink to this headline"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Note that localhost could be a location somewhere else, like a source IP Address of machine connecting to mysql</span>
revoke DROP on databasename.tablename from <span class="s1">&#39;username&#39;</span>@<span class="s1">&#39;localhost&#39;</span><span class="p">;</span>
flush privileges<span class="p">;</span>
</pre></div>
</div>
</section>
<section id="showing-privileges">
<h3>Showing Privileges<a class="headerlink" href="#showing-privileges" title="Permalink to this headline"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>show grants <span class="k">for</span> <span class="s1">&#39;username&#39;</span>@<span class="s1">&#39;host&#39;</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="updating-data">
<h3>Updating Data<a class="headerlink" href="#updating-data" title="Permalink to this headline"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>update table <span class="nb">set</span> <span class="nv">column1</span><span class="o">=</span>newvalue1, <span class="nv">column2</span><span class="o">=</span>newvalue2, where condition<span class="p">;</span>
</pre></div>
</div>
</section>
<section id="deleting-data">
<h3>Deleting Data<a class="headerlink" href="#deleting-data" title="Permalink to this headline"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>delete from table_name where condition<span class="p">;</span>
</pre></div>
</div>
</section>
<section id="checking-mysql-status">
<h3>Checking MySQL Status<a class="headerlink" href="#checking-mysql-status" title="Permalink to this headline"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>service mysqld status
ps aux <span class="p">|</span> grep mysql
</pre></div>
</div>
</section>
<section id="backup">
<h3>Backup<a class="headerlink" href="#backup" title="Permalink to this headline"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Backup directly to a remote host (zabbix is the DB name)</span>
<span class="c1"># That pipes the mysqldump command through gzip, then to through and SSH connection. SSH on the remote side runs the ‘cat’ command to read the stdin, then redirects that to the actual file where I want it saved.</span>
mysqldump -u root -p zabbix <span class="p">|</span> gzip -c <span class="p">|</span> ssh caleb.sargeant@server.example.com <span class="s2">&quot;cat &gt; zabbix.sql.gz&quot;</span>
</pre></div>
</div>
</section>
<section id="restore">
<h3>Restore<a class="headerlink" href="#restore" title="Permalink to this headline"></a></h3>
<p>The file must be in .sql format. It can not be compressed in a .zip or .tar.gz file.</p>
<p><code class="docutils literal notranslate"><span class="pre">mysql</span> <span class="pre">-p</span> <span class="pre">-u</span> <span class="pre">username</span> <span class="pre">database_name</span> <span class="pre">&lt;</span> <span class="pre">file.sql</span></code></p>
</section>
<section id="use">
<h3>Use<a class="headerlink" href="#use" title="Permalink to this headline"></a></h3>
<p><a class="reference external" href="https://www.tutorialspoint.com/mysql/mysql-select-database.htm">https://www.tutorialspoint.com/mysql/mysql-select-database.htm</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>show databases<span class="p">;</span>
use database<span class="p">;</span>
</pre></div>
</div>
</section>
<section id="setting-up-replication">
<h3>Setting up Replication<a class="headerlink" href="#setting-up-replication" title="Permalink to this headline"></a></h3>
<p><a class="reference external" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-replication-in-mysql">https://www.digitalocean.com/community/tutorials/how-to-set-up-replication-in-mysql</a></p>
</section>
<section id="size-of-db">
<h3>Size of DB<a class="headerlink" href="#size-of-db" title="Permalink to this headline"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>SELECT table_schema <span class="s2">&quot;zabbix&quot;</span>,
        ROUND<span class="o">(</span>SUM<span class="o">(</span>data_length + index_length<span class="o">)</span> / <span class="m">1024</span> / <span class="m">1024</span>, <span class="m">1</span><span class="o">)</span> <span class="s2">&quot;DB Size in MB&quot;</span>
FROM information_schema.tables
GROUP BY table_schema<span class="p">;</span>
</pre></div>
</div>
</section>
<section id="resetting-root-password">
<h3>Resetting Root Password<a class="headerlink" href="#resetting-root-password" title="Permalink to this headline"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>/etc/init.d/mysqld stop
mysqld_safe --skip-grant-tables <span class="p">&amp;</span>
mysql -u root
mysql&gt; use mysql<span class="p">;</span>
mysql&gt; update user <span class="nb">set</span> <span class="nv">password</span><span class="o">=</span>PASSWORD<span class="o">(</span><span class="s2">&quot;newrootpassword&quot;</span><span class="o">)</span> where <span class="nv">User</span><span class="o">=</span><span class="s1">&#39;root&#39;</span><span class="p">;</span>
mysql&gt; flush privileges<span class="p">;</span>
mysql&gt; quit
/etc/init.d/mysqld stop
/etc/init.d/mysqld start
</pre></div>
</div>
</section>
<section id="resetting-user-password">
<h3>Resetting User Password<a class="headerlink" href="#resetting-user-password" title="Permalink to this headline"></a></h3>
<p><a class="reference external" href="https://linuxize.com/post/how-to-change-mysql-user-password/">https://linuxize.com/post/how-to-change-mysql-user-password/</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># MySQL v5.7.6 or later / MariaDB 10.1.20 or later</span>
ALTER USER <span class="s1">&#39;user-name&#39;</span>@<span class="s1">&#39;localhost&#39;</span> IDENTIFIED BY <span class="s1">&#39;NEW_USER_PASSWORD&#39;</span><span class="p">;</span>
FLUSH PRIVILEGES<span class="p">;</span>

<span class="c1"># If the above didn&#39;t work:</span>
UPDATE mysql.user SET <span class="nv">authentication_string</span> <span class="o">=</span> PASSWORD<span class="o">(</span><span class="s1">&#39;NEW_USER_PASSWORD&#39;</span><span class="o">)</span> WHERE <span class="nv">User</span> <span class="o">=</span> <span class="s1">&#39;user-name&#39;</span> AND <span class="nv">Host</span> <span class="o">=</span> <span class="s1">&#39;localhost&#39;</span><span class="p">;</span>
FLUSH PRIVILEGES<span class="p">;</span>

<span class="c1"># MySQL v5.7.5 or earlier / MariaDB 10.1.20 or earlier</span>
SET PASSWORD FOR <span class="s1">&#39;user-name&#39;</span>@<span class="s1">&#39;localhost&#39;</span> <span class="o">=</span> PASSWORD<span class="o">(</span><span class="s1">&#39;NEW_USER_PASSWORD&#39;</span><span class="o">)</span><span class="p">;</span>
FLUSH PRIVILEGES<span class="p">;</span>
</pre></div>
</div>
</section>
<section id="update-encrypted-password">
<h3>Update Encrypted Password<a class="headerlink" href="#update-encrypted-password" title="Permalink to this headline"></a></h3>
<p><a class="reference external" href="https://stackoverflow.com/questions/56527343/update-encrypted-password-in-mysql-database">https://stackoverflow.com/questions/56527343/update-encrypted-password-in-mysql-database</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>update table <span class="nb">set</span> <span class="nv">password</span><span class="o">=</span>encrypt<span class="o">(</span>password<span class="o">)</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="allow-root-access-without-password-as-root">
<h3>Allow Root Access without Password as Root<a class="headerlink" href="#allow-root-access-without-password-as-root" title="Permalink to this headline"></a></h3>
<p><a class="reference external" href="https://serverfault.com/questions/563714/allow-linux-root-user-mysql-root-access-without-password">https://serverfault.com/questions/563714/allow-linux-root-user-mysql-root-access-without-password</a></p>
<p>In ~/.my.cnf file as root user:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>client<span class="o">]</span>
<span class="nv">user</span><span class="o">=</span>root
<span class="nv">password</span><span class="o">=</span>somepassword
</pre></div>
</div>
</section>
<section id="checking-the-version">
<h3>Checking the Version<a class="headerlink" href="#checking-the-version" title="Permalink to this headline"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># https://stackoverflow.com/questions/8987679/how-to-retrieve-the-current-version-of-a-mysql-database-management-system-dbms</span>
<span class="k">select</span> @@version<span class="p">;</span>
</pre></div>
</div>
</section>
<section id="checking-database-size">
<h3>Checking Database Size<a class="headerlink" href="#checking-database-size" title="Permalink to this headline"></a></h3>
<p><a class="reference external" href="https://stackoverflow.com/questions/1733507/how-to-get-size-of-mysql-database">https://stackoverflow.com/questions/1733507/how-to-get-size-of-mysql-database</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>SELECT table_schema <span class="s2">&quot;DB Name&quot;</span>,
      ROUND<span class="o">(</span>SUM<span class="o">(</span>data_length + index_length<span class="o">)</span> / <span class="m">1024</span> / <span class="m">1024</span>, <span class="m">1</span><span class="o">)</span> <span class="s2">&quot;DB Size in MB&quot;</span>
FROM information_schema.tables
GROUP BY table_schema<span class="p">;</span>
</pre></div>
</div>
</section>
<section id="connect-to-database-remotely">
<h3>Connect to Database Remotely<a class="headerlink" href="#connect-to-database-remotely" title="Permalink to this headline"></a></h3>
<p><a class="reference external" href="https://docs.rackspace.com/support/how-to/mysql-connect-to-your-database-remotely/">https://docs.rackspace.com/support/how-to/mysql-connect-to-your-database-remotely/</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mysql -u fooUser -p -h <span class="m">44</span>.55.66.77
</pre></div>
</div>
</section>
<section id="import-database-with-progress-bar">
<h3>Import Database with Progress Bar<a class="headerlink" href="#import-database-with-progress-bar" title="Permalink to this headline"></a></h3>
<p><a class="reference external" href="https://gist.github.com/infusion/492418723b6736784af1">https://gist.github.com/infusion/492418723b6736784af1</a></p>
<p><a class="reference external" href="https://dba.stackexchange.com/questions/17367/how-can-i-monitor-the-progress-of-an-import-of-a-large-sql-file">https://dba.stackexchange.com/questions/17367/how-can-i-monitor-the-progress-of-an-import-of-a-large-sql-file</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pv dump.sql.tar.gz <span class="p">|</span> tar xO <span class="p">|</span> mysql -u <span class="nv">$user</span> -p <span class="nv">$database</span>
<span class="c1"># Or</span>
pv sqlfile.sql <span class="p">|</span> mysql -u root -p database
</pre></div>
</div>
</section>
<section id="reinstall-mysql-after-deleting-var-lib-mysql">
<h3>Reinstall Mysql after Deleting /var/lib/mysql<a class="headerlink" href="#reinstall-mysql-after-deleting-var-lib-mysql" title="Permalink to this headline"></a></h3>
<p><a class="reference external" href="https://dba.stackexchange.com/questions/103625/how-to-reinitialise-var-lib-mysql-files">https://dba.stackexchange.com/questions/103625/how-to-reinitialise-var-lib-mysql-files</a></p>
<p><a class="reference external" href="https://mariadb.com/kb/en/mysql_secure_installation/">https://mariadb.com/kb/en/mysql_secure_installation/</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir /var/lib/mysql
mkdir /var/lib/mysql/mysql
chown -R mysql:mysql /var/lib/mysql
mysql_secure_installation
</pre></div>
</div>
</section>
<section id="could-not-open-mysql-plugin-table">
<h3>Could not open mysql.plugin table<a class="headerlink" href="#could-not-open-mysql-plugin-table" title="Permalink to this headline"></a></h3>
<p><a class="reference external" href="https://stackoverflow.com/questions/34198735/could-not-open-mysql-plugin-table-some-plugins-may-be-not-loaded/46147066">https://stackoverflow.com/questions/34198735/could-not-open-mysql-plugin-table-some-plugins-may-be-not-loaded/46147066</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>systemctl stop mariadb
<span class="c1"># This will delete all database data!</span>
rm -R /var/lib/mysql/*
mysql_install_db --user<span class="o">=</span>mysql --basedir<span class="o">=</span>/usr --datadir<span class="o">=</span>/var/lib/mysql
systemctl start mariadb
</pre></div>
</div>
</section>
<section id="mysql-refuses-remote-connections">
<h3>Mysql Refuses Remote Connections<a class="headerlink" href="#mysql-refuses-remote-connections" title="Permalink to this headline"></a></h3>
<p><a class="reference external" href="https://serverfault.com/questions/586651/mysql-refuses-to-accept-remote-connections">https://serverfault.com/questions/586651/mysql-refuses-to-accept-remote-connections</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># my.cnf</span>
<span class="o">[</span>mysqld<span class="o">]</span>
bind-address <span class="o">=</span> <span class="m">0</span>.0.0.0
</pre></div>
</div>
</section>
<section id="access-denied-for-user-root-at-localhost">
<h3>Access Denied for User Root at Localhost<a class="headerlink" href="#access-denied-for-user-root-at-localhost" title="Permalink to this headline"></a></h3>
<p><a class="reference external" href="https://stackoverflow.com/questions/41645309/mysql-error-access-denied-for-user-rootlocalhost">https://stackoverflow.com/questions/41645309/mysql-error-access-denied-for-user-rootlocalhost</a></p>
</section>
<section id="authentication-plugin-caching-sha2-password-cannot-be-loaded">
<h3>Authentication Plugin Caching Sha2 Password Cannot be Loaded<a class="headerlink" href="#authentication-plugin-caching-sha2-password-cannot-be-loaded" title="Permalink to this headline"></a></h3>
<p><a class="reference external" href="https://stackoverflow.com/questions/49194719/authentication-plugin-caching-sha2-password-cannot-be-loaded">https://stackoverflow.com/questions/49194719/authentication-plugin-caching-sha2-password-cannot-be-loaded</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ALTER USER <span class="s1">&#39;yourusername&#39;</span>@<span class="s1">&#39;localhost&#39;</span> IDENTIFIED WITH mysql_native_password BY <span class="s1">&#39;youpassword&#39;</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="change-mysql-temp-folder">
<h3>Change MySQL Temp Folder<a class="headerlink" href="#change-mysql-temp-folder" title="Permalink to this headline"></a></h3>
<p><a class="reference external" href="https://stackoverflow.com/questions/49899160/change-mysql-tmp-to-somedrive-mysqltmp-in-centos-7-for-error-code-28">https://stackoverflow.com/questions/49899160/change-mysql-tmp-to-somedrive-mysqltmp-in-centos-7-for-error-code-28</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>nano /etc/mysqld.cnf
  <span class="o">[</span>mysqld<span class="o">]</span>
  <span class="nv">tmpdir</span><span class="o">=</span>/var/lib/mysql/tmp
mysqld --verbose --help <span class="p">|</span> grep tmp
</pre></div>
</div>
</section>
<section id="installing-mysql">
<h3>Installing MySQL<a class="headerlink" href="#installing-mysql" title="Permalink to this headline"></a></h3>
<p><a class="reference external" href="https://www.digitalocean.com/community/tutorials/how-to-install-mysql-on-ubuntu-20-04">https://www.digitalocean.com/community/tutorials/how-to-install-mysql-on-ubuntu-20-04</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>apt install mysql-server
mysql_secure_installation
</pre></div>
</div>
</section>
<section id="json-like-query">
<h3>Json Like Query<a class="headerlink" href="#json-like-query" title="Permalink to this headline"></a></h3>
<p><a class="reference external" href="https://stackoverflow.com/questions/42918348/postgresql-json-like-query">https://stackoverflow.com/questions/42918348/postgresql-json-like-query</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="k">select</span> * from module_data where data::json-&gt;&gt;<span class="s1">&#39;title&#39;</span> like <span class="s1">&#39;%Board%&#39;</span>
<span class="k">select</span> * from module_data where data-&gt;&gt;<span class="s1">&#39;title&#39;</span> like <span class="s1">&#39;%Board%&#39;</span>
</pre></div>
</div>
</section>
<section id="converting-epoch-to-human-readable-date">
<h3>Converting Epoch to Human Readable Date<a class="headerlink" href="#converting-epoch-to-human-readable-date" title="Permalink to this headline"></a></h3>
<p><a class="reference external" href="https://stackoverflow.com/questions/23994889/converting-epoch-number-to-human-readable-date-in-mysql">https://stackoverflow.com/questions/23994889/converting-epoch-number-to-human-readable-date-in-mysql</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="k">select</span> from_unixtime<span class="o">()</span><span class="p">;</span>
</pre></div>
</div>
</section>
</section>
<section id="postgresql">
<h2>PostgreSQL<a class="headerlink" href="#postgresql" title="Permalink to this headline"></a></h2>
<section id="deleting-rows">
<h3>Deleting Rows<a class="headerlink" href="#deleting-rows" title="Permalink to this headline"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>delete from msisdn_seen where msisdn like <span class="s1">&#39;27234843223&#39;</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="selecting-rows">
<h3>Selecting Rows<a class="headerlink" href="#selecting-rows" title="Permalink to this headline"></a></h3>
<p><a class="reference external" href="https://stackoverflow.com/questions/924729/how-to-best-display-in-terminal-a-mysql-select-returning-too-many-fields">https://stackoverflow.com/questions/924729/how-to-best-display-in-terminal-a-mysql-select-returning-too-many-fields</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># remember to use \G to display it nicely</span>
<span class="k">select</span> * from msisdn_seen where msisdn like <span class="s1">&#39;27234843223&#39;</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="updating-data-in-table">
<h3>Updating Data in Table<a class="headerlink" href="#updating-data-in-table" title="Permalink to this headline"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>update table_name <span class="nb">set</span> <span class="nv">column1</span><span class="o">=</span>value1 where condition<span class="p">;</span>
</pre></div>
</div>
</section>
<section id="show-tables">
<h3>Show Tables<a class="headerlink" href="#show-tables" title="Permalink to this headline"></a></h3>
<p><a class="reference external" href="https://www.postgresqltutorial.com/postgresql-show-tables/">https://www.postgresqltutorial.com/postgresql-show-tables/</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="se">\d</span>t
</pre></div>
</div>
</section>
<section id="connect-to-database">
<h3>Connect to Database<a class="headerlink" href="#connect-to-database" title="Permalink to this headline"></a></h3>
<p>Same as use in mysql <a class="reference external" href="https://www.tutorialspoint.com/postgresql/postgresql_select_database.htm">https://www.tutorialspoint.com/postgresql/postgresql_select_database.htm</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="se">\c</span> database<span class="p">;</span>
</pre></div>
</div>
</section>
<section id="backup-database">
<h3>Backup Database<a class="headerlink" href="#backup-database" title="Permalink to this headline"></a></h3>
<p><a class="reference external" href="https://dba.stackexchange.com/questions/17740/how-to-get-a-working-and-complete-postgresql-db-backup-and-test">https://dba.stackexchange.com/questions/17740/how-to-get-a-working-and-complete-postgresql-db-backup-and-test</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pg_dumpall -U postgres -h localhost --clean --file<span class="o">=</span>dump.sql
</pre></div>
</div>
</section>
<section id="disable-pager">
<h3>Disable Pager<a class="headerlink" href="#disable-pager" title="Permalink to this headline"></a></h3>
<p><a class="reference external" href="https://stackoverflow.com/questions/39850860/disable-wrapping-in-psql-output">https://stackoverflow.com/questions/39850860/disable-wrapping-in-psql-output</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">PAGER</span><span class="o">=</span><span class="s2">&quot;less -S&quot;</span> psql
</pre></div>
</div>
</section>
<section id="extracting-json">
<h3>Extracting JSON<a class="headerlink" href="#extracting-json" title="Permalink to this headline"></a></h3>
<p><a class="reference external" href="https://stackoverflow.com/questions/42918348/postgresql-json-like-query">https://stackoverflow.com/questions/42918348/postgresql-json-like-query</a>
<a class="reference external" href="https://popsql.com/learn-sql/postgresql/how-to-query-a-json-column-in-postgresql">https://popsql.com/learn-sql/postgresql/how-to-query-a-json-column-in-postgresql</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="k">select</span> event_time,detail-&gt;&gt;<span class="s1">&#39;msisdn&#39;</span>,detail-&gt;&gt;<span class="s1">&#39;attachment&#39;</span> from table where <span class="nv">whatever</span><span class="o">=</span>whatever and event_time &gt; <span class="s1">&#39;2021-12-22 00:00:01&#39;</span> and event_time &lt;<span class="o">=</span> <span class="s1">&#39;2022-01-07 23:59:59&#39;</span> and detail-&gt;&gt;<span class="s1">&#39;attachment&#39;</span> like <span class="s1">&#39;%this%&#39;</span> order by id desc<span class="p">;</span>
</pre></div>
</div>
</section>
<section id="reducing-disk-usage">
<h3>Reducing Disk Usage<a class="headerlink" href="#reducing-disk-usage" title="Permalink to this headline"></a></h3>
<p><a class="reference external" href="https://stackoverflow.com/questions/39198380/delete-temporary-files-in-postgresql#:~:text=1%20Answer&amp;text=The%20temporary%20files%20that%20get,not%20delete%20them%20by%20hand">https://stackoverflow.com/questions/39198380/delete-temporary-files-in-postgresql#:~:text=1%20Answer&amp;text=The%20temporary%20files%20that%20get,not%20delete%20them%20by%20hand</a>.</p>
<p>Temporary files are created in <cite>base/pgsql_tmp</cite>. Rebooting psql forces the clearing of tmp files by restarting the cleanup query.</p>
</section>
<section id="show-running-queries">
<h3>Show Running Queries<a class="headerlink" href="#show-running-queries" title="Permalink to this headline"></a></h3>
<p><a class="reference external" href="https://gist.github.com/rgreenjr/3637525">https://gist.github.com/rgreenjr/3637525</a>
<a class="reference external" href="https://stackoverflow.com/questions/11291456/terminate-hung-query-idle-in-transaction#:~:text=Long%2Dlasting%20%22idle%20in%20transaction%22%20should%20be%20avoided%2C,can%20cause%20major%20performance%20problems">https://stackoverflow.com/questions/11291456/terminate-hung-query-idle-in-transaction#:~:text=Long%2Dlasting%20%22idle%20in%20transaction%22%20should%20be%20avoided%2C,can%20cause%20major%20performance%20problems</a>.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">pid</span><span class="p">,</span><span class="w"> </span><span class="n">age</span><span class="p">(</span><span class="n">clock_timestamp</span><span class="p">(),</span><span class="w"> </span><span class="n">query_start</span><span class="p">),</span><span class="w"> </span><span class="n">usename</span><span class="p">,</span><span class="w"> </span><span class="n">query</span><span class="w"></span>
<span class="k">FROM</span><span class="w"> </span><span class="n">pg_stat_activity</span><span class="w"></span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s1">&#39;&lt;IDLE&gt;&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">ILIKE</span><span class="w"> </span><span class="s1">&#39;%pg_stat_activity%&#39;</span><span class="w"></span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">query_start</span><span class="w"> </span><span class="k">desc</span><span class="p">;</span><span class="w"></span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">pg_stat_activity</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="connect-to-postgresql-server-fatal-no-pg-hba-conf-entry-for-host">
<h3>Connect to PostgreSQL server FATAL no pg_hba.conf entry for host<a class="headerlink" href="#connect-to-postgresql-server-fatal-no-pg-hba-conf-entry-for-host" title="Permalink to this headline"></a></h3>
<p><a class="reference external" href="https://dba.stackexchange.com/questions/83984/connect-to-postgresql-server-fatal-no-pg-hba-conf-entry-for-host">https://dba.stackexchange.com/questions/83984/connect-to-postgresql-server-fatal-no-pg-hba-conf-entry-for-host</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># postgresql.conf</span>
<span class="nv">listen_addresses</span> <span class="o">=</span> <span class="s1">&#39;*&#39;</span>

<span class="c1"># pg_hba.conf</span>
<span class="c1"># TYPE DATABASE USER CIDR-ADDRESS  METHOD</span>
host  all  all <span class="m">0</span>.0.0.0/0 md5

service postgresql restart
</pre></div>
</div>
</section>
<section id="vacuum">
<h3>Vacuum<a class="headerlink" href="#vacuum" title="Permalink to this headline"></a></h3>
<p><a class="reference external" href="https://stackoverflow.com/questions/4759503/how-can-i-perform-the-vacuum-using-the-postgresql#:~:text=Connect%20to%20the%20database%20and,which%20will%20also%20update%20statistics">https://stackoverflow.com/questions/4759503/how-can-i-perform-the-vacuum-using-the-postgresql#:~:text=Connect%20to%20the%20database%20and,which%20will%20also%20update%20statistics</a>.</p>
<p>Vacuuming your postgres db must be done once in a while.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>VACUUM<span class="p">;</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Linux" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="general.html" class="btn btn-neutral float-right" title="General" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Caleb Sargeant.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>