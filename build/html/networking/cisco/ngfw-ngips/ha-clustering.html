

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>High Availability and Clustering &mdash; Caleb Sargeant&#39;s Docs 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Implementing Access Control" href="access-control.html" />
    <link rel="prev" title="Networking with Firewall Capabilities" href="networking-with-firewall-capabilities.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> Caleb Sargeant's Docs
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Networking</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Cisco</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../core-security/index.html">Core Security</a></li>
<li class="toctree-l2"><a class="reference internal" href="../routing/index.html">Routing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../switching/index.html">Switching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mpls/index.html">MPLS</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">NGFW &amp; NGIPS</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="introduction.html">Introduction to NGFW &amp; NGIPS</a></li>
<li class="toctree-l3"><a class="reference internal" href="networking-with-firewall-capabilities.html">Networking with Firewall Capabilities</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">High Availability and Clustering</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#clustering">Clustering</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="access-control.html">Implementing Access Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="firepower-ips.html">FirePOWER Intrusion Policies</a></li>
<li class="toctree-l3"><a class="reference internal" href="amp.html">Advanced Malware Protection (AMP)</a></li>
<li class="toctree-l3"><a class="reference internal" href="security-intelligence.html">Security Intelligence, Security Updates, and Keeping Firepower Software Up to Date</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../devnetday/index.html">DevNet Day</a></li>
<li class="toctree-l2"><a class="reference internal" href="../aci.html">ACI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../asa.html">ASA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../asav.html">ASAv</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dna.html">DNA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general.html">General</a></li>
<li class="toctree-l2"><a class="reference internal" href="../genie.html">Genie</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ise.html">ISE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nexus.html">Nexus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nso.html">NSO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../virl.html">VIRL</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../fortigate.html">FortiGate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hp.html">HP Procurve</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../juniper.html">Juniper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ubiquiti-unifi.html">Ubiquiti UniFi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../netdevops-toolchest.html">NetDevOps Tool Chest</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Computing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../computing/ansible/index.html">Ansible</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../computing/bamboo.html">Bamboo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../computing/cloud/index.html">Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../computing/containerisation/index.html">Containerisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../computing/jenkins/index.html">Jenkins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../computing/linux/index.html">Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../computing/terraform/index.html">Terraform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../computing/microsoft/index.html">Microsoft</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Programming</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../programming/bash.html">Bash</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../programming/python/index.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../programming/golang/index.html">Golang</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../other/api/index.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../other/general/index.html">General</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../other/iperf.html">iPerf3</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Caleb Sargeant's Docs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Cisco</a> &raquo;</li>
        
          <li><a href="index.html">NGFW &amp; NGIPS</a> &raquo;</li>
        
      <li>High Availability and Clustering</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../_sources/networking/cisco/ngfw-ngips/ha-clustering.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="high-availability-and-clustering">
<h1>High Availability and Clustering<a class="headerlink" href="#high-availability-and-clustering" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>HA (failover) or cluster</p></li>
<li><p>Identical FTD devices or identical ASA devices</p></li>
<li><p>State link between devices</p></li>
<li><p>ASA supports active-active &amp; active-standby. FTD only supports active-standby</p></li>
<li><p>Only active passes traffic</p></li>
<li><p>Failover and stateful links are dedicated</p></li>
<li><p>Stateful link is used to pass connection state information. Ensure that it the bandwidth available is equal on both sides. Latency must be less than 10ms, no more than 250ms.</p></li>
</ul>
<p>Active-standby failover:</p>
<img alt="../../../_images/ha-clustering-1.png" src="../../../_images/ha-clustering-1.png" />
<p>Communication over the failover link:</p>
<ul class="simple">
<li><p>The firewall state (active or standby)</p></li>
<li><p>Hello messages (keepalives)</p></li>
<li><p>Network link status</p></li>
<li><p>MAC address exchange</p></li>
<li><p>Configuration replication and synchronisation</p></li>
</ul>
<p>Failover configuration requirements:</p>
<ul class="simple">
<li><p>The two participant devices must be configured in the same firewall mode (for example, routed or transparent).</p></li>
<li><p>The two participant devices must be running the same software version.</p></li>
<li><p>You can configure different Cisco FTD devices in groups (or domains) in the Cisco FMC. Devices configured for failover must be in the same domain or group on the Cisco FMC.</p></li>
<li><p>The two participant devices must have the same Network Time Protocol (NTP) configuration (and time must be synchronized).</p></li>
<li><p>Failover participant devices must be fully deployed with no uncommitted changes in the Cisco FMC.</p></li>
<li><p>DHCP or PPPoE must not be configured on any of their interfaces.</p></li>
<li><p>Same licenses - FMC releases any unnecessary licenses assigned to the standby device and replaces them with identical licenses assigned to the active and standby device.</p></li>
</ul>
<p>Methods for connecting failover link:</p>
<ul class="simple">
<li><p>Use a switch with dedicated network segment (VLAN or broadcast domain).</p></li>
<li><p>Direct connection between the two devices with the same ethernet speeds and ethernet numbers.</p></li>
</ul>
<div class="section" id="clustering">
<h2>Clustering<a class="headerlink" href="#clustering" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://h4cker.org/scor/clustering.html">https://h4cker.org/scor/clustering.html</a></p>
<ul class="simple">
<li><p>Multiple FTDs into one, logical device.</p></li>
<li><p>Supported only on 4100 &amp; 9300.</p></li>
<li><p>Increased throughput and redundancy.</p></li>
<li><p>Cluster-control link (by default, port-channel 48) for unit-to-unit communication. Data and control traffic, state update and forwarded packets are sent over this link. Must be sized to handle comms of all members.</p></li>
<li><p>Intra-chassis clustering can occur in 9300, using backplane for cluster comms.</p></li>
<li><p>Inter-chassis clustering is achieved by allocating 1 or more physical interfaces in EtherChannel.</p></li>
<li><p>Firepower chassis supervisor pushes minimal bootstrap config to each unit that has cluster name and control link interface settings when deploying cluster.</p></li>
<li><p>FTD cluster assigns data interfaces to the cluster as spanned interfaces.</p></li>
<li><p>FTD cluster members share policy and traffic flows.</p></li>
<li><p>One FTD is the master unit (automatically determined), others are slaves. Master is either the first unit joining or on config’d priority.</p></li>
<li><p>All config is done on master unit and replicated to slaves.</p></li>
<li><p>New master is elected when master leaves cluster.</p></li>
<li><p>Master handles all management and centralised functions.</p></li>
<li><p>All members must be connected to single management network (separate to cluster control link). Management interfaces must be assigned when enabling clustering to be able to connect directly to member.</p></li>
</ul>
<p>4 FTD devices connected to 2 switches:</p>
<img alt="../../../_images/ha-clustering-2.png" src="../../../_images/ha-clustering-2.png" />
<p>FTD cluster unit state transition:</p>
<img alt="../../../_images/ha-clustering-3.png" src="../../../_images/ha-clustering-3.png" />
<ol class="arabic simple">
<li><p>After the unit boots, it looks for a master over the cluster control link.</p></li>
<li><p>If there are no master units, it waits 45 seconds before assuming the master role. If a master already exists, it becomes a slave and the configuration is synchronized.</p></li>
<li><p>If there is a synchronisation or health issue, the unit is considered disabled in the cluster.</p></li>
</ol>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="access-control.html" class="btn btn-neutral float-right" title="Implementing Access Control" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="networking-with-firewall-capabilities.html" class="btn btn-neutral float-left" title="Networking with Firewall Capabilities" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Caleb Sargeant.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>